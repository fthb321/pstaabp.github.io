
Chapter 11: Creating New Data Types in Julia
=====

[Return to all notes](../index.html)


We will start to look at playing cards (poker) probabilities below.  Before that, let's look at a different datatype in Julia that allows us to store more that one variable together.  This is often called a composite type or a struct (from C) and similar to an object however you can't have a function as a member of the type.

###Card datatype

For our playing card example, a card has a rank (1 to 13 corresponding to Ace, 2, through 10, J, Q, K) and a suit (1 to 4 corresponding to the suits "clubs", "spades", "diamonds" and "hearts"), which we define

```
ranks = ["A","2","3","4","5","6","7","8","9","T","J","Q","K"];
suits = ["C","S","D","H"];
```

We can define this using a Julia type [See the julia manual on composite types](http://docs.julialang.org/en/release-0.3/manual/types/).

```
type Card
    rank::Int
    suit::Int
    Card(r::Int,s::Int)=new(r,s)
    Card(i::Int) = i%13==0? new(13,int(ceil(i/13))) : new(i%13,int(ceil(i/13)))
end
```

and if we type
```
Card(3,2)
```

this will create a card of rank 3 and suit 2 (spades).  Since this isn't very easy to read we produce a function that prints the card.

```
function printCard(c::Card)
    return ranks[c.rank]*suits[c.suit];
end
```

And for example typing `printCard(Card(3,2))`  returns "3S" or 3 of spades.  Note: the `*` in julia with string will concantenate.  

You may notice that there is also a way to create a card from a single integer.  For example, `printCard(Card(45))` returns "6H", which would be the 45th card in an ordered deck.  This method will be useful when we get to a deck of cards.  

Since a Hand is also helpful in playing card games, we will define a hand in the following way:
```
type Hand
    cards::Array{Card,1}
end
```

which is just an array of cards.  (Note: there is nothing here that specifies that the Hand has to be 5 cards, but that could be included.)

Next are functions that retun the rank and suit of a card:

```
function cardrank(c::Card)
    return c.rank
end
```

```
function cardsuit(c::Card)
    return c.suit
end
```


Let's create a Hand by typing
```
h=Hand([Card(2,3),Card(12,1),Card(10,1),Card(10,4),Card(5,2)])
```

and then we can print out a hand by defining a printHand function
```
function printHand(h::Hand)
    join(map(printCard,h.cards),",")
end
```

and with the above hand:
```
printHand(h)
```

returns "2D,QC,TC,TH,5S"

###Find Probabilities of Poker Hands

Let's actually look at determining if a hand is a particular poker hand.  Some of them are fairly difficult to test for. Let's first try a full house:

```
function isFullHouse(h::Hand)
	local cranks=sort(map(cardrank,h.cards))
	return cranks[2]==cranks[1] && cranks[5]==cranks[4] && (cranks[3]==cranks[2] || cranks[4]==cranks[3]);
end
```

Now, let's perform a Monte Carlo simulation on a large number of poker hands and test if this gives the result we want:

```
deck=[1:52];
numhands=0;
trials = 100000
for i=1:trials
    shuffle!(deck)
    h = Hand(map(Card,deck[1:5]))
    if(isFullHouse(h))
        numhands+=1
    end
end
numflushes/trials
```

will create 100,000 poker hands and test how many are full house.  
