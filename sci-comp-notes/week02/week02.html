<!DOCTYPE html>  
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <title>week02</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
body{-webkit-font-smoothing:antialiased;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;margin:30px 0 0;padding:0;background:#fff}#wrapper{padding:20px}li{font-size:110%}li li{font-size:100%}li p{font-size:100%;margin:.5em 0}h1{color:#000}h2{color:#111}h3{color:#111;margin:0}h4{color:#111}h5{color:#111}h6{font-size:1em;line-height:1.5em;margin:1.5em 0}body,p,td,div{color:#111;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;word-wrap:break-word}a{color:#0d6ea1;text-decoration:none;-webkit-transition:color 0.2s ease-in-out;-moz-transition:color 0.2s ease-in-out;-o-transition:color 0.2s ease-in-out;-ms-transition:color 0.2s ease-in-out;transition:color 0.2s ease-in-out}a:hover{color:#3593d9}body{font-size:15px;line-height:21px;margin:0 auto}h1{font-size:37px;line-height:42px;margin-top:42px;margin-bottom:21px}h2{font-size:27px;line-height:42px;margin-top:42px;margin-bottom:21px}h3{font-size:20px;line-height:21px;margin-top:21px;margin-bottom:21px}h4{font-size:20px;line-height:21px;margin-top:21px;margin-bottom:21px}p,ul,ol,pre,table,blockquote{margin-top:21px;margin-bottom:21px}hr{border:1px solid;margin:-1px 0}ul ul,ol ol,ul ol,ol ul{margin-top:0;margin-bottom:0}b,strong,em,small,code{line-height:1}.footnote{color:#0d6ea1;font-size:.8em;vertical-align:super}#wrapper img{max-width:100%;height:auto}dd{font-size:1em;margin-bottom:1em}li>p:first-child{margin:0}ul ul,ul ol{margin-bottom:.4em}caption,col,colgroup,table,tbody,td,tfoot,th,thead,tr{border-spacing:0}table{border:1px solid rgba(0,0,0,0.25);border-collapse:collapse;display:table;empty-cells:hide;margin:-1px 0 1.3125em;padding:0;table-layout:fixed}caption{display:table-caption;font-weight:700}col{display:table-column}colgroup{display:table-column-group}tbody{display:table-row-group}tfoot{display:table-footer-group}thead{display:table-header-group}td,th{display:table-cell}tr{display:table-row}table th,table td{font-size:1.1em;line-height:23px;padding:0 1em}table thead{background:rgba(0,0,0,0.15);border:1px solid rgba(0,0,0,0.15);border-bottom:1px solid rgba(0,0,0,0.2)}table tbody{background:rgba(0,0,0,0.05)}table tfoot{background:rgba(0,0,0,0.15);border:1px solid rgba(0,0,0,0.15);border-top:1px solid rgba(0,0,0,0.2)}figure{display:inline-block;overflow:hidden;position:relative;margin:1em 0 2em}figcaption{font-style:italic;text-align:center;background:white;color:#666;position:absolute;left:0;bottom:-24px;width:98%;padding:1%;-webkit-transition:all 0.2s ease-in-out;-moz-transition:all 0.2s ease-in-out;-o-transition:all 0.2s ease-in-out;-ms-transition:all 0.2s ease-in-out;transition:all 0.2s ease-in-out}.poetry pre{display:block;font-family:Georgia,Garamond,serif !important;font-size:110% !important;font-style:italic;line-height:1.6em;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif !important;word-break:break-all;word-break:break-word;-webkit-hyphens:auto;-moz-hyphens:auto;hyphens:auto;white-space:pre-wrap}blockquote p{font-size:110%;font-style:italic;line-height:1.6em}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;position:relative;vertical-align:super}sub{vertical-align:sub;top:-1px}p,h5{font-size:1.1429em;line-height:1.3125em;margin:1.3125em 0}dt,th{font-weight:700}table tr:nth-child(odd),table th:nth-child(odd),table td:nth-child(odd){background:rgba(255,255,255,0.06)}table tr:nth-child(even),table td:nth-child(even){background:rgba(200,200,200,0.25)}@media print{body{font-size:13px !important}img,table,figure{page-break-inside:avoid}#wrapper{background:#fff;color:#303030;padding:10px;position:relative;text-indent:0}}@media screen{.inverted{background:#252a2a}.inverted #wrapper{background:#252a2a;color:#eee}.inverted hr{border-color:#333f40 !important}.inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dt,.inverted dd{color:#eee}.inverted pre{background:#ccc}.inverted pre code{color:#111}.inverted table{background:none}.inverted table tr:nth-child(odd),.inverted table td:nth-child(odd){background:none}.inverted a{color:#acd1d5}::selection{background:rgba(157,193,200,0.5)}h1::selection{background-color:rgba(45,156,208,0.3)}h2::selection{background-color:rgba(90,182,224,0.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,0.3)}code::selection{background-color:rgba(0,0,0,0.7);color:#eee}code span::selection{background-color:rgba(0,0,0,0.7) !important;color:#eee !important}a::selection{background-color:rgba(255,230,102,0.2)}.inverted a::selection{background-color:rgba(255,230,102,0.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,0.5)}}

@media print{
#generated-toc-clone,#generated-toc{display:none!important}
}
#generated-toc-clone li.missing,#mkreplaced-toc li.missing{list-style-type:none!important}#generated-toc-clone li, #mkreplaced-toc li{list-style-type:upper-roman}#generated-toc-clone li li, #mkreplaced-toc li li{list-style-type:decimal}#generated-toc-clone li li li,#mkreplaced-toc li li li{list-style-type:decimal-leading-zero}#generated-toc-clone li li li li,#mkreplaced-toc li li li li{list-style-type:lower-greek}#generated-toc-clone li li li li li,#mkreplaced-toc li li li li li{list-style-type:disc}#generated-toc-clone li li li li li li,#mkreplaced-toc li li li li li li{list-style-type:square}
</style>

</head>
<body class="normal">
  <div id="wrapper">
      <h1 id="week-2-notes----">Week 2 Notes    </h1>

<p>These are the notes for week 2 of Math 3001.  <a href="../index.html">Return to all notes</a></p>

<h2 id="rounding-errors-and-the-quadratic-formula----">Rounding Errors and the Quadratic Formula    </h2>

<p>The following example shows how a well-know formula (the quadratic formula) can lead to incorrect results due to rounding errors.</p>

<p>Remember if you solve \(a{x}^{2}+bx+c=0\), the the quadratic formula finds the solution:  <br/>
\[ x=\frac{-b \pm \sqrt{{b}^{2}-4ac}} {2a}\]</p>

<p>Next, let&rsquo;s consider the quadratic equation \(12.242{x}^{2}+42.382x+0.0012=0\)</p>

<p>We are going to solve this using the quadratic equation in julia</p>

<ol>
<li><p>Write a function for the quadratic formula.</p>

<p> <pre><code class="(null)"> qSol = function(a,b,c)
       d=sqrt(b^2-4*a*c)
       return (-b+d)/(2*a),(-b-d)/(2*a)
       end</code></pre></p>

<p> (Exercise)</p>

<p> Use the quadratic formula to solve \({x}^{2}-x-110=0\).</p></li>
<li><p>Solve the equation above using 64-bit floating point.</p>

<p> <pre><code class="(null)">x1a,x1b = qSol(12.242,42.382,0.0012)</code></pre>  <br/>
to</p>

<p>  <pre><code class="(null)">(-2.831413841486606e-5,-3.461987696317393)</code></pre></p></li>
<li><p>Find the solution if the coefficients are 16-bit floating points.</p>

<p> <pre><code class="(null)">x2a,x2b = qSol(float16(12.242),float16(42.382),float16(0.0012))</code></pre>  <br/>
to</p>

<p>  <pre><code class="(null)">(0.0001448952f0,-3.4615362f0)</code></pre></p></li>
<li><p>Assume that the 64-bit answer is correct.  Find the absolute and relative errors for the two solutions.</p>

<p> The absolute errors are</p>

<p> <pre><code class="(null)">abs(x1a-x2a) = 0.00017320933367737267
abs(x1b-x2b) = 0.0004515272652687585</code></pre></p>

<p> and the relative errors are:</p>

<p> <pre><code class="(null)">abs(x1a-x2a)/abs(x1a) = 6.117414951479887
abs(x1b-x2b)/abs(x1b) = 0.00013044129635438729</code></pre></p>

<p> This shows that the first answer is far off in relative terms.</p></li>
</ol>


<h2 id="be-skeptical-of-numerical-answers----">Be skeptical of numerical answers    </h2>

<p>Even though the example above was manufactured to produce bad results, you never know if a numerical solution is accurate or not.</p>

<h2 id="can-we-ever-be-confident-of-answers-----">Can we ever be confident of answers?    </h2>

<p>It&rsquo;s crucial to have a good sense of the problem (whether it be mathematical or a scientific question).  Additionally, testing is an important part of the solution process.</p>

<p>Let&rsquo;s reexamine the quadratic formula.  The problem arose due to roundoff.</p>

<h2 id="let-s-change-the-quadratic-formula----">Let&rsquo;s change the quadratic formula    </h2>

<p>I&rsquo;m going to assume that \(b>0\) and let \(d=\sqrt{b^{2}-4ac}\). The roundoff occurs when the value of \(b\) and \(d\) are close to each other.  In the case above, b=42.382 and \(d=\sqrt{b^{2}-4ac}=42.38130675663505\).  Notice that the other root (solution) was correct to many decimal places.</p>

<p>To change the quadratic formula we are going to exchange the addition with a subtraction (however we will not have the catastrophic subtraction error we saw above).  &ldquo;How can you do that you ask?&rdquo; Here we go&hellip;</p>

<p>Start with the quadratic formula (only the + root):  <br/>
\[ x=\frac{-b + \sqrt{{b}^{2}-4ac}} {2a}\]</p>

<p>Multiply by a convenient form of 1  <br/>
\[ x=\frac{-b + \sqrt{{b}^{2}-4ac}} {2a} \cdot \frac{-b-\sqrt{b^{2}-4ac}}{-b-\sqrt{b^{2}-4ac}}\]</p>

<p>\[ x = \frac{-b^{2}+b^{2}-4ac}{2a(-b-\sqrt{b^{2}-4ac})}\]</p>

<p>\[ x = \frac{2c}{b+\sqrt{b^{2}-4ac}}\]</p>

<p>and there is a similar solution if the - root is taken above.  So an alternative quadratic formula is:</p>

<pre><code class="(null)">qSol2 = function(a,b,c)
  d=sqrt(b^2-4*a*c)
  return 2*c/(b+d),(2*c)/(b-d)
end</code></pre>


<p></p>

<h3 id="exercise">Exercise</h3>

<ul>
<li><p>Use the new quadratic formula (<code>qSol2</code>) to find the roots of \(x^{2}-x-110=0\).  Do you get the same results as above?</p></li>
<li><p>Use the new quadratic formula to solve \(12.242{x}^{2}+42.382x+0.0012=0\).  Find the absolute an relative errors.  What results do you find?</p></li>
</ul>


<h2 id="newton-s-method----">Newton&rsquo;s Method    </h2>

<p>Solving an equation is a very important part of mathematics and other scientific fields.  However, finding general solutions to equations is not very easy.  Consider a cubic equation like \( cubic \).    In the spirit of (but not very simple) the quadratic formula, there is a <a href="https://en.wikipedia.org/wiki/Cubic_function#Roots_of_a_cubic_function">cubic formula</a>.  Much of the wikipedia page spends time solving the cubic with all possibilities.  In short, it&rsquo;s not very easy.</p>

<p>In lieu of using such a formula, a more robust approach is to solve it numerically.  Let&rsquo;s consider</p>

<p>\[15{x}^{3}-143{x}^2+226x+280=0\]</p>

<p>This cubic actually factors, but finding those factors is quite difficult to do in general.  We then look at using <a href="https://en.wikipedia.org/wiki/Newton%27s_method">Newton&rsquo;s method</a> to solve this.</p>

<p>Newton&rsquo;s method starts with a &ldquo;guess&rdquo; at the root and then refines it.  Let \(x_0\) be the guess, then  <br/>
\[x_1 = x_0 - \frac{f(x_0)}{f'(x_0)}\]</p>

<p>Let&rsquo;s look at this in Julia for the function above.</p>

<pre><code class="(null)">f(x)=15x^3-143x^2+226x+280</code></pre>


<p></p>

<p>and we need the derivative so</p>

<pre><code class="(null)">df(x)=45x^2-286x+226</code></pre>


<p></p>

<p>Let&rsquo;s say that x0=0 and find x1 using Newton&rsquo;s method:</p>

<pre><code class="(null)">x0 = 0
x1 = x0-f(x0)/df(x0)</code></pre>


<p></p>

<p>returns <code>-1.238938053097345</code>.  If we then let x0=x1 and repeat we get a sequence that hopefully gets close to a root (solution). After a few iterations, you should get <code>-0.8</code></p>

<h3 id="exercise">Exercise</h3>

<ul>
<li><p>Try to find the other two solutions to this function.  (Hint: try different values for x0)</p></li>
<li><p>Write a function using the arguments f,df and x0 and returns the root.</p></li>
</ul>


<h2 id="packages-in-julia----">Packages in Julia    </h2>

<p>As with most languages, you can add extra functionality to Julia via a package.  <a href="http://pkg.julialang.org">A list of all of the packages</a> shows over 200 currently (Sept 2014).  To add a package, generally it&rsquo;s done with</p>

<pre><code class="(null)">Pkg.add(name)</code></pre>


<p></p>

<p>where name is a string. If there are other packages that are dependencies, Julia takes care of those also.  Type</p>

<pre><code class="(null)">Pkg.update()</code></pre>


<p></p>

<p>to update all packages, which is a good idea to do often as things are changing quickly in the Julia world. And to list all of the packages you have installed, type</p>

<pre><code class="(null)">Pkg.status()</code></pre>


<p></p>

<p>For example, if you want to load in the Calculus package, type</p>

<pre><code class="(null)">Pkg.add(&quot;Calculus&quot;)</code></pre>


<p></p>

<p>And now you will have some Calculus functionality. For example,</p>

<pre><code class="(null)">using Calculus
f(x)=x^2
f&apos;(1)</code></pre>


<p></p>

<p>returns close to 2.  (It doesn&rsquo;t calculate derivatives exactly.)  Note: the first line loads in the package.  (similar to the with statement in Maple).</p>

<h2 id="plots-in-julia----">Plots in Julia    </h2>

<p>There are a number of plotting packages in Julia.  One of the simpler ones in called Winston and one of the more robust ones is called PyPlot.  We&rsquo;ll first look at some examples in Winston.  First, make sure the packages is added.</p>

<pre><code class="(null)">Pkg.add(&quot;Winston&quot;)</code></pre>


<p></p>

<p>(this might take a while).  Then create two 1D arrays (vectors) for x and y and plot.</p>

<pre><code class="(null)">x=[-2:0.1:2]
y=map(a-&gt;a^2,x)
plot(x,y)</code></pre>


<p></p>

<h3 id="exercise">Exercise</h3>

<p>Try plotting some other functions, like \(\sin x\), \(e<sup>x</sup>\), \(\ln x\) and play with the plotting domain (x values of the plot).</p>

<p>For additional documentation on Winston, you can find a link from the <a href="http://pkg.julialang.org">Julia packages website</a></p>

<h2 id="newton-s-method-to-find-all-the-roots----">Newton&rsquo;s Method to find all the roots    </h2>

<p>Newton&rsquo;s method generally finds a single root based on an input (though this is not guaranteed).  What if we want to find all of the roots?   We could generate an array of initial points and apply Newton&rsquo;s method to every point. Here&rsquo;s one approach.</p>

<p>Note: assume that we have a function called <code>newton</code> that given a function, its derivative and an initial point, returns the root.  (I will provide one soon).</p>

<p>Let&rsquo;s produce an array of initial values:</p>

<pre><code class="(null)">x0=[-10:1:10]</code></pre>


<p></p>

<p>To find the point with that initial point, we can use the <code>map</code> function</p>

<pre><code class="(null)">x=map(a-&gt;newton(f,df,a),x0)</code></pre>


<p></p>

<p>will return an array of the root that the function went to.  Now to get a more visual sense of where the points go:</p>

<pre><code class="(null)">plot(x0,x)</code></pre>


<p></p>

<p>shows for each x value (the initial point) which root the function goes to.</p>

<h2 id="complex-numbers----">Complex Numbers    </h2>

<p>Last week we briefly saw complex numbers. A site called purplemath.com has a <a href="http://www.purplemath.com/modules/complex.htm">nice overview of complex numbers</a>.  Here&rsquo;s a few example using Julia to do complex arithmetic.</p>

<p>Entering the number \(a+bi\) is put in with <code>a+b*im</code>.  For example <code>-2+im</code> or <code>0.5*1.5im</code>.</p>

<p>Operations with complex numbers:</p>

<pre><code class="(null)">(-2+im)^2
(-2+im)*(7+4im)
(-2+im)/(7+4im)</code></pre>


<p></p>

<p>Other operations/mathematical functions work as well</p>

<pre><code class="(null)">sqrt(-1+0im)
sin(-2+im)
e^(-5.42+32.3im)=exp(-5.42+32.3im)</code></pre>


<p></p>

<p>however, these may not make sense (unless you seen some complex analysis).</p>

<div style="display:none">    
<!--This seemingly unnecessary div markup is the only thing keeping this script working after Markdown conversion. Trust me.-->    
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>    
</div>


<p></p>
<!-- ##END MARKED WRAPPER## -->
    </div>
</body>
</html>