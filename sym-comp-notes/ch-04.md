Differential Calculus Problems in Maple
========

This chapter covers how to perform many mathematics that arises from Calculus using a CAS like Maple.  As we will see, a CAS will often do limits and derivatives quite easily, allowing us to investigate the geometry of the derivative using a plot or a table of values, which are often helpful for gaining intuition about limits and derivatives. 

Limits
-----

You may need to review the basics of a limit from Calculus.  If we say
$$L = \lim_{x \rightarrow 2} x^2$$ 
then $L$ is the value of the function $x^2$ as $x$ approaches 1 (from either side), but not at exactly 1.  We can examine this using a plot of the function:

![Plot of $x^2$](images/ch04/plot1.png)

And from the plot it appears that the limit is 1, however, you can never say precisely with a plot, but this can help verify a result.  

Another way to attack this is with a table.  Let's find the value of the function $f(x)=x^2$, at the points $x=0.9,0.99,0.999,1.001,1.01,1.1$.  We can do this easily with the `map` function.  If

```
f:=x->x^2
xvals := [.9, .99, .999, 1.001, 1.01, 1.1]
map(f,xvals)
```
will produce the function values of all of the $x$ values given or
```
[.81, .9801, .998001, 1.002001, 1.0201, 1.21]
```

It would be really nice to have a table formatted nicer.  If instead we typed
```
map(x->[x,f(x)],xvals)
```
then we get the following:
```
[[.9, .81], [.99, .9801], [.999, .998001], [1.001, 1.002001], [1.01, 1.0201], [1.1, 1.21]]
```
which still doesn't look nice, but if we wrap the function in `Matrix` as in:
```
Matrix(map(x->[x,f(x)],xvals))
```
it will look like: $$\left[ \begin {array}{cc}  0.9& 0.81\newline 
0.99&0.9801\newline
0.999& 0.998001\newline
 1.001& 1.002001\newline
 1.01& 1.0201\newline
 1.1& 1.21\end {array} \right] 
$$

and then the only other addition might be to label the columns, which can be done in the following way.  If we redo `xvals` to include a term $x$ at the front or:
```
xvals := [x,.9, .99, .999, 1.001, 1.01, 1.1]
```
then rerunning: 
```
Matrix(map(x->[x,f(x)],xvals))
```
will result in the matrix $$\left[\begin{array}{cc} x &  x^{2}\newline
0.9 & 0.81 \newline
0.99&0.9801\newline
0.999& 0.998001\newline
 1.001& 1.002001\newline
 1.01& 1.0201\newline
 1.1& 1.21
\end{array}\right]$$

As you can now see from the table above, as $x$ gets closer to 1, $x^2$ gets closer to 1.  You're thinking, duh, $1^{2}=1$, which is true, but we often use a limit when you can't just evaluate a function at the point $a$.  

###Exercise
Reproduce the table above using $$f(x)= \frac{x^{2}-4}{x-2}$$ 
when $a=2$.  Use an appropriate set of points that are both less than and greater than 2.  Guess a value of the limit.  


###Using Maple's built-in Limit function. 


Now, of course, Maple (and any CAS) will do the limit for us.  If you type out `limit`, hit the ESC key, select the first item, you will see:
$$\lim_{x\rightarrow a} f$$
and you can fill in $a$ and $f$ (and change $x$ if it's a different variable).  So doing this for the limit above results in:
$$\lim_{x \rightarrow 1}x^{2}$$
and maple will return 1.  

###Exercise
Try evaluating the following limits:
1. $$\lim_{x \rightarrow 2} \frac{x^{2}-4}{x-2}$$
2. $$\lim_{t \rightarrow 0} \frac{\sin t}{t}$$
3. $$\lim_{x \rightarrow 1} \frac{\ln x}{x-1}$$

Secant and Tangent Lines
------

Recall that a secant line through a function is the line that passes through the function at two points.  For example, consider the secant line through the function $f(x)=x^2$ that passes through the function when $x=1$ and $x=2$.  A plot of this is:

![A plot of $x^{2}$ and it secant line](images/ch04/plot2.png)

and you can see from the plot that indeed the line passes through the given points.  Also, recall to find the slope of the secant line, we'll need to evaluate the function at the $x$ values.  
```
f:=x->x^2
m:=(f(2)-f(1))/(2-1)
```
which is 3 in this case.  We can then use the point-slope form of the line with either the point $(1,1)$ or $(2,4)$.  

The reason that we discuss secant lines in Calculus, is that we want to know the tangent line, which is the line that just touches at a single point.  We can't find a line given only one point, but if we find a number of secant lines that pass through (1,1), we hopefully can find a trend that leads to the tangent line.  Then we will use calculus to do this precisely.  

If instead of defining the slope of the line through $(1,1)$ and $(2,4)$, instead, let's make a function that is the slope of the line that passes through $(1,1)$ and $(x,x^{2})$. 

```
m:=x->(f(x)-f(1))/(x-1)
```

Now this will allow us to find the slope of the secant line for any point $x$.  We can also build a table like above.  
```
xvals := [1.5,1.9, 1.99, 1.999, 2.001, 2.01, 2.1,2.5]
Matrix(map)
```

And you will see $$\left[ \begin {array}{cc}  
0.5 & 1.500000000 \newline
0.9& 1.900000000\newline
0.99 & 1.990000000\newline
0.999& 1.999000000\newline
1.001& 2.001000000\newline
1.01& 2.010000000\newline
1.1& 2.100000000\newline
1.5& 2.500000000
\end {array}\right]$$

We can use this to estimate the tangent line of $m=2$ which we will verify below. 


Visually, we can plot the secant lines and function as well.   If we type
```
lines:=map(t->m(t)*(x-1)+1,xvals)
```
we will get a list of lines out.  We can plot these together with the function by typing:
```
plot([x^2,op(lines)],x=-0.5..2.5
```
you will get the following plot:


![Plot of $x^2$ and secant lines](images/ch04/plot3.png)

This plot is awfully busy and hard to see.  However, we can animate the line by the following:
```
plots[animate](plot, [[x^2, m(t)*(x-1)+1], x = -.1 .. 2.1], t = xvals)
```

(or loading in the `plots` library first).  We will cover this in detail in the next chapter.  After this runs, you can play it sequentially with the play button or go through the frames one by one or loop it.  See the help page on `plots[animate]` for more details.  

###The tangent line

The actual tangent line to the curve $y=x^2$ can be found by taking the limit of the slopes of the secant lines or
```
limit(m(x),x=1)
```
will do the limit 
$$\lim_{x \rightarrow 1} \frac{x^2-1}{x-1}$$
and return 2. Therefore the tangent line is
```
tanLine:=2*(x-1)+1
```
and a plot of the function with its tangent line at $x=1$ is given as

![Plot of $x^2$ and its tangent line](images/ch04/plot4.png)

Asymptotes
------

In precalculus you were introduced to asymptotes of functions.  In generally, an asympote of a function is a line that the function approaches far from the origin.  In calculus, there is a more specific definition.  

###Horizontal Asymptotes

The line $y=L$ is a **horizontal asymptote** of a function $f(x)$ if 
$$
\lim_{x \rightarrow \infty} f(x) = L
$$ 

or

$$
\lim_{x \rightarrow -\infty} f(x) = L
$$ 
and visually, you can see a horizontal asymptote by looking at a function and determining it is approaching a horizontal line as $x \rightarrow \infty$ or $x \rightarrow -\infty$.  

For example, consider the function 
$$
f(x) = \frac{2x-1}{x-3}$$

A plot of this is

![Plot of $\frac{2x-1}{x-3}$](images/ch04/plot5.png)

and (it's bit hard to see), but there is a horizontal asymptote which is about $y=2$.  (Recall that an asymptote is a line, so you should write it as such)

Since this is hard to see, we can use the definition above to find the limit.  Doing
$$
\lim_{x \rightarrow \infty} \frac{2x-1}{x-3}
$$

and 

$$
\lim_{x \rightarrow \infty} \frac{2x-1}{x-3}
$$

returns 2 in both cases.  Therefore $y=2$ is the only horizontal asymptote.  

###Vertical Asymptotes

The definition of a vertical asymptote is a bit more complicated.  The line $x=a$ is a vertical asymptote of the function $f(x)$ if at least one of the following is true

$\lim_{x \rightarrow a} f(x)=\infty$ or $\lim_{x \rightarrow a^+} f(x)=\infty$ or $\lim_{x \rightarrow a^-} f(x)=\infty$ or

$\lim_{x \rightarrow a} f(x)=-\infty$ or $\lim_{x \rightarrow a^+} f(x)=-\infty$ or $\lim_{x \rightarrow a^-} f(x)=-\infty$

In other words, the limit (one-sided or both-sided) is infinite. 

For the function seen above, the line $x=3$ is a vertical asympote because 
$$\lim_{x \rightarrow 3^+} \frac{2x-1}{x-3}=\infty$$

Now this provides a way to prove that a vertical line is a vertical asymptote, but not how to find them.  If you have a rational function (polynomial over a polynomial), then possible vertical asympotes are where the denominator is 0.    For example, let's look at the function 
$$
R(x) = \frac{x^2-1}{x^3-13x+12}
$$

We can find the possible vertical asymptotes by finding the zeros of the denominator or
```
solve(denom(R(x)))
```
which returns 1,3,-4. 

If you check if each zero above is a vertical asymptotes, you will notice that the limit at $x=1$ is $-\frac{1}{5}$, and not infinite.  The left- and right-handed limits at $x=3$ and $x=-4$ are infinite, so those are vertical asympotes.  This is also consistent with the plot of the function:

![Plot of the function $R(x)$](images/ch04/plot6.png)

###Using the built-in Asymptotes function

Maple also has the ability to find all of the asympototes using a built-in function.  First, let's load the `Student[Calculus1]` package:
```
with(Student[Calculus1]):
```
and recall to suppress the output of all of the commands that are imported, put a colon (:) at the end of the line.  Then type
```
Asymptotes(R(x))
```
returns `[y = 0, x = -4, x = 3]`, which saves a lot of work, but you should know how to find and show each is indeed an asymptote.  



Derivatives
------

Applications of Derivatives
-------

